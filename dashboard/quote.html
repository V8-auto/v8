<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>V8 Powered Auto - Quote</title>
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/assets/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/assets/favicon-16x16.png"
    />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: Arial, sans-serif;
        background: #0f1724;
      }

      .logo {
        width: 60px;
        height: 60px;
        background: transparent;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 12px;
        text-align: center;
      }

      .main-container {
        display: flex;
        height: 100vh; /* full viewport height */
        overflow: hidden; /* no body scroll */
        align-items: stretch; /* make children fill height */
      }
      .sidebar {
        width: 260px;
        background: rgba(15, 23, 36);
        border-right: 1px solid rgba(255, 255, 255, 0.03);
        padding: 28px 20px;
        display: flex;
        flex-direction: column;
        gap: 20px;
        transform: translateX(0);
        transition: var(--transition);
        z-index: 40;
        backdrop-filter: blur(6px) saturate(120%);
      }
      .close-btn {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: white; /* match sidebar text color */
        display: none; /* hidden by default */
      }
      .sidebar.open .close-btn {
        display: block; /* show when sidebar opens */
      }

      @media (max-width: 820px) {
        .sidebar {
          position: fixed;
          left: 0;
          top: 0;
          height: 100vh;
          transform: translateX(-320px);
        }
        .sidebar.open {
          transform: translateX(0);
        }
      }
      .quote-container {
        background-color: #ffffff;
        flex: 1; /* fills remaining width next to sidebar */
        overflow-y: auto; /* vertical scroll if content overflows */
        padding: 10px; /* optional internal padding */
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
      }

      /* Action Buttons */
      .action-buttons {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
      }
      /* Mobile menu toggle (hidden by default, shown on small screens) */
      .menu-toggle {
        display: none;
        background: transparent;
        border: none;
        color: #fff;
        font-size: 20px;
        cursor: pointer;
        padding: 6px 8px;
      }
      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        transition: 0.3s;
      }
      .btn-primary {
        background: #d32f2f;
        color: white;
      }
      .btn-primary:hover {
        background: #b71c1c;
      }
      .btn-secondary {
        background: #333;
        color: white;
      }
      .btn-secondary:hover {
        background: #000;
      }
      .btn-success {
        background: #4caf50;
        color: white;
      }
      .btn-success:hover {
        background: #388e3c;
      }

      /* Header */
      .header .header-info {
        display: none;
        border-bottom: 3px solid #333;
        padding-bottom: 20px;
        margin-bottom: 30px;
      }
      .company-name {
        font-size: 28px;
        font-weight: bold;
        color: #d32f2f;
        margin-bottom: 5px;
      }
      .header-info {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 10px;
        margin-top: 15px;
      }
      .contact-info {
        flex: 1;
        font-size: 12px;
        line-height: 1.6;
        color: #666;
        max-width: 40%;
      }
      .contact-info .office-addresses {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-top: 8px;
        margin-bottom: 8px;
        font-size: 12px;
        color: #666;
      }
      .contact-info .office-addresses .office {
        line-height: 1.4;
      }
      .quote-meta {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 10px;
        width: 40%;
        min-width: 300px;
      }

      .quote-type {
        font-size: 32px;
        font-weight: bold;
        text-align: right;
        color: #333;
        margin-bottom: 10px;
      }
      .meta-box {
        background: #f9f9f9;
        padding: 8px 12px;
        display: flex;
        align-items: center;
        gap: 10px;
        width: 100%;
        justify-content: space-between;
        border-radius: 4px;
      }
      .meta-label {
        font-size: 11px;
        color: #666;
        text-transform: uppercase;
        min-width: 120px;
        font-weight: 600;
      }
      .meta-value {
        font-size: 14px;
        font-weight: bold;
      }
      input[type="text"],
      input[type="date"],
      input[type="number"],
      textarea {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
      }
      textarea {
        resize: vertical;
        min-height: 80px;
        font-family: Arial, sans-serif;
      }

      /* Client & Vehicle Info */
      .info-section {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }

      .info-title {
        font-size: 12px;
        font-weight: bold;
        background: #8d8989;
        color: rgb(255, 255, 255);
        padding: 8px;
        margin-bottom: 10px;
      }
      .info-content {
        padding: 10px;
        font-size: 13px;
        line-height: 1.8;
      }
      .info-row {
        display: flex;
        margin-bottom: 1px;
        align-items: center;
      }
      .info-row strong {
        min-width: 120px;
        color: #666;
      }
      .info-row input {
        flex: 1;
      }

      /* Items Table Alignment Styles */

      .items-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 30px;
      }

      .items-table thead {
        background: #333;
        color: white;
      }

      .items-table th {
        padding: 12px;
        font-size: 12px;
        text-transform: uppercase;
      }

      /* First column (Description) - left aligned */
      .items-table th:first-child {
        text-align: left;
      }

      /* All other columns - right aligned */
      .items-table th.text-center,
      .items-table th.text-right {
        text-align: right;
      }

      .items-table td {
        padding: 8px;
        border-bottom: 1px solid #eee;
        font-size: 14px;
      }

      /* First column (Description) - left aligned */
      .items-table td:first-child {
        text-align: left;
      }

      /* All other data cells - right aligned */
      .items-table td.text-center,
      .items-table td.text-right {
        text-align: right;
      }

      /* Inputs inside table cells inherit alignment */
      .items-table input {
        width: 100%;
        padding: 6px;
        border: 1px solid #ddd;
        border-radius: 4px;
      }

      /* Description input - left aligned */
      .items-table td:first-child input,
      .items-table .item-desc {
        text-align: left;
      }

      /* Quantity and Price inputs - right aligned */
      .items-table .text-center input,
      .items-table .item-qty,
      .items-table .text-right input,
      .items-table .item-price {
        text-align: right;
      }

      .items-table .net-price {
        display: block;
        text-align: right;
        font-weight: bold;
      }

      /* Print styles for table */

      .btn-remove {
        background: #f44336;
        color: white;
        padding: 5px 10px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
      }
      .btn-remove:hover {
        background: #d32f2f;
      }
      .btn-add {
        background: #4caf50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        margin-bottom: 20px;
      }
      .btn-add:hover {
        background: #388e3c;
      }

      .totals {
        margin-left: auto; /* Push to the right */
        margin-right: 0;
        width: 300px; /* Fixed width */
        display: block;
      }

      .total-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 15px;
        font-size: 14px;
      }

      .total-row span:first-child {
        text-align: left;
        font-weight: 500;
      }

      .total-row span:last-child {
        text-align: right;
        font-weight: bold;
        min-width: 120px;
      }

      .total-row.subtotal {
        border-top: 2px solid #eee;
      }

      .total-row.grand-total {
        background: #333;
        color: white;
        padding: 15px;
        font-size: 18px;
        font-weight: bold;
        margin-top: 10px;
        border-radius: 4px;
      }

      .total-row.grand-total span {
        color: white;
      }

      /* Print styles for totals */
      @media print {
        .totals {
          width: 180px !important;
          margin-left: auto !important;
          margin-right: 0 !important;
          margin-bottom: 10px !important;
          display: block !important;
        }

        .total-row {
          padding: 3px 6px !important;
          font-size: 10px !important;
        }

        .total-row span:last-child {
          min-width: 80px !important;
        }

        .total-row.subtotal {
          border-top: 1px solid #eee !important;
        }

        .total-row.grand-total {
          padding: 6px 8px !important;
          font-size: 11px !important;
          margin-top: 4px !important;
          background: #333 !important;
          -webkit-print-color-adjust: exact !important;
          print-color-adjust: exact !important;
        }
      }
      .signatures {
          display: none;
        }
      .footer {
        display: none;
        margin-top: 40px;
        padding-top: 20px;
        border-top: 2px solid #eee;
      }
      .bank-details {
        background: #f9f9f9;
        padding: 15px;
      }
      .bank-title {
        font-weight: bold;
        margin-bottom: 10px;
        color: #d32f2f;
      }
      .bank-info {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        font-size: 13px;
      }
      .bank-info div {
        margin-bottom: 5px;
      }
      .bank-info strong {
        color: #666;
      }
      .addresses {
        margin-top: 20px;
        font-size: 12px;
        color: #666;
      }
      .addresses div {
        margin-bottom: 5px;
      }

      @media print {
        * {
          -webkit-print-color-adjust: exact !important;
          print-color-adjust: exact !important;
        }

        body,
        html {
          margin: 0;
          padding: 0;
          background: white;
        }
        .main-container {
          display: flex;
          height: auto; /* full viewport height */
          overflow: hidden; /* prevent body scroll */
          min-height: auto;
        }
        .quote-container {
          display: block !important;
        }
        .top-header {
          display: none !important;
        }
        .header {
    display: block; /* Visible when printing */
  }
        .calendly-inline-widget {
          display: none !important;
        }
        #sidebar {
          display: none !important;
        }
        /* Main quote container */
        .quote-container {
          height: auto; /* Not 100vh or fixed height */
          min-height: auto;
          width: 100%;
          max-width: 100%;
          margin: 0;
          padding: 15mm 10mm; /* Adjust margins for A4 paper */
          box-shadow: none;
          background: white;
          display: flex;
          flex-direction: column;
        }
        .header-info {
          display: flex !important;
          flex-direction: row !important;
          justify-content: space-between !important;
          align-items: flex-start !important;
          gap: 20px !important;
          width: 100% !important;
        }

        .contact-info {
          flex: 0 0 48% !important; /* Fixed width of 48% */
          max-width: 48% !important;
        }

        .quote-meta {
          flex: 0 0 48% !important; /* Fixed width of 48% */
          max-width: 48% !important;
          align-self: flex-start !important;
        }

        /* Optional: Adjust logo size for print */
        .contact-info img {
          max-width: 200px !important;
          height: auto !important;
        }

        /* Ensure the logo container doesn't break the layout */
        .contact-info > div:first-child {
          margin-bottom: 10px !important;
        }

        .header-info .contact-info .office-addresses {
          display: grid !important;
          grid-template-columns: 1fr 1fr !important;
          gap: 6px !important;
          margin-top: 3px !important;
          margin-bottom: 3px !important;
          font-size: 8px !important;
        }

        .header-info .contact-info .office {
          line-height: 1.2 !important;
        }

        /* Quote meta */
        .header-info .quote-meta {
          flex: 0 0 auto;
          min-width: 300px;
          display: flex !important;
          flex-direction: column !important;
          align-items: flex-end !important;
          gap: 4px !important;
          margin-top: 0 !important;
          margin-left: auto !important;
          padding-top: 0 !important;
        }

        .header-info .quote-meta .quote-type {
          font-size: 36px !important;
          text-align: right !important;
          width: 200px !important;
          height: auto !important;
          margin-bottom: 3px !important;
        }

        .header-info .quote-meta .meta-box {
          background: #f9f9f9 !important;
          padding: 3px 6px !important;
          margin-bottom: 2px !important;
          width: 100% !important;
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          border-radius: 2px !important;
        }

        .header-info .quote-meta .meta-label {
          font-size: 8px !important;
          min-width: 100px !important;
          text-align: left !important;
          font-weight: 600 !important;
          color: #666 !important;
        }

        .header-info .quote-meta .meta-box input {
          border: none !important;
          background: transparent !important;
          padding: 1px !important;
          font-size: 9px !important;
          text-align: right !important;
          font-weight: bold !important;
          flex: 1 !important;
        }

        input[type="text"],
        input[type="date"],
        input[type="number"],
        textarea {
          border: none !important;
          background: transparent !important;
          font-size: 10px;
          padding: 0;
          line-height: 1.3;
        }
        .items-table {
          margin-bottom: 8px !important;
          font-size: 9px !important;
        }

        .items-table th {
          padding: 3px 4px !important;
          font-size: 8px !important;
        }

        .items-table td {
          padding: 2px 3px !important;
          font-size: 9px !important;
        }

        .items-table input {
          font-size: 8px !important;
          padding: 1px !important;
          border: none !important;
          background: transparent !important;
        }

        /* Description - left aligned */
        .items-table th:first-child,
        .items-table td:first-child,
        .items-table td:first-child input {
          text-align: left !important;
        }

        /* All other columns - right aligned */
        .items-table th.text-center,
        .items-table th.text-right,
        .items-table td.text-center,
        .items-table td.text-right,
        .items-table td.text-center input,
        .items-table td.text-right input,
        .items-table .net-price {
          text-align: right !important;
        }
        /* Info section */
        .info-section {
          display: flex;
          gap: 10px;
          margin-bottom: 10px;
          font-size: 9px;
        }

        .info-box {
          flex: 1;
        }

        .info-title {
          font-size: 10px;
          padding: 3px 5px;
        }

        .info-content {
          font-size: 9px;
          padding: 5px;
        }

        textarea {
          height: auto !important;
          min-height: 60px;
          resize: none;
        }

        .info-row {
          margin-bottom: 3px;
          font-size: 9px;
        }

        /* Items table */
        .items-table {
          width: 100%;
          font-size: 9px;
          margin-bottom: 10px;
        }

        .items-table th {
          font-size: 9px;
          padding: 5px;
        }

        .items-table td {
          padding: 4px;
          font-size: 9px;
        }

        .items-table input {
          font-size: 9px !important;
        }

        /* Hide buttons in print */
        .btn-add,
        .btn-remove,
        button {
          display: none !important;
        }

        /* Totals section */
        .totals {
          font-size: 10px;
          margin-bottom: 10px;
        }

        .total-row {
          padding: 4px 0;
        }

        .grand-total {
          font-size: 12px;
        }
        .signatures {
          display: block;
        }
        /* Footer */
        .footer {
          display: block;
          font-size: 9px;
          margin-top: 15px;
          page-break-inside: avoid;
        }

        .bank-title {
          font-size: 10px;
          padding: 3px 5px;
        }

        .bank-info {
          font-size: 9px;
          padding: 5px;
        }

        .footer p {
          font-size: 9px !important;
        }

        /* Ensure single page */
        @page {
          size: A4;
          margin: 10mm 8mm;
        }

        .header,
        .info-section,
        .totals,
        .footer {
          page-break-inside: avoid;
        }

        /* If content still doesn't fit, scale it down */
        .quote-container {
          transform: scale(0.95);
          transform-origin: top left;
        }
      }

      /* Mobile Responsive */
      @media (max-width: 768px) {
        .top-header {
          flex-direction: column;
          gap: 15px;
        }
        header-info {
          flex-direction: column;
        }

        .contact-info {
          max-width: 100%;
        }
        /* show menu toggle on small screens, hide full menu by default */
        .menu-toggle {
          display: block !important;
        }
        .menu-items {
          display: none !important;
        }
        .quote-container {
          padding: 20px;
        }
        .action-buttons {
          flex-wrap: wrap;
        }
        .header-info {
          flex-direction: column;
        }
        .quote-type {
          text-align: left;
          margin-top: 10px;
        }
        .quote-meta,
        .info-section {
          grid-template-columns: 1fr;
        }
        .items-table {
          font-size: 12px;
        }
        .items-table th,
        .items-table td {
          padding: 6px 4px;
        }
        .totals {
          width: 100%;
        }
        .bank-info {
          grid-template-columns: 1fr;
        }
      }
    </style>
    <style>
      .hambtn {
        width: 46px;
        height: 46px;
        border-radius: 10px;
        background: var(--glass);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--muted);
        cursor: pointer;
        border: 1px solid rgba(255, 255, 255, 0.02);
      }
      @media (min-width: 1024px) {
        .hambtn {
          display: none;
        }
        .close-btn {
          display: none;
        }
      }
      .nav {
        margin-top: 6px;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .nav a {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 12px;
        color: #cfe9f7;
        text-decoration: none;
        border-radius: 10px;
        transition: var(--transition);
        font-size: 14px;
      }
      .nav a .ico {
        width: 36px;
        height: 36px;
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.02);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--muted);
      }
      .nav a:hover {
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0.02),
          rgba(255, 255, 255, 0.01)
        );
        transform: translateX(4px);
      }
      .nav a.active {
        background: linear-gradient(
          90deg,
          rgba(124, 58, 237, 0.15),
          rgba(6, 182, 212, 0.06)
        );
        color: #fff;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
      }
      .spacer {
        flex: 1;
      }
    </style>
  </head>
  <body>
    <div class="main-container">
      <div class="top-left">
        <button
          class="hambtn"
          id="hambtn"
          style="color: #cfe9f7"
          aria-label="Open menu"
        >
          ‚ò∞
        </button>
      </div>
      <aside id="sidebar" class="sidebar" aria-hidden="true">
        <button id="closeSidebar" class="close-btn" aria-label="Close menu">
          ‚úï
        </button>
        <div class="brand">
          <div class="logo">
            <img
              src="/assets/img/solidflo-logo.png"
              style="height: 60px"
              alt=""
            />
          </div>
          <div>
            <p style="color: #9aa7b2; font-size: 12px">Quotations & Billing</p>
          </div>
        </div>

        <nav class="nav" aria-label="Main navigation">
          <a class="active" href="/dashboard/index.html"
            ><span class="ico">üè†</span><span class="label">Dashboard</span></a
          >
          <a href="/dashboard/invoices.html"
            ><span class="ico">üìÑ</span><span class="label">Invoices</span></a
          >
          <a class="active" href="/dashboard/quotations.html">
            <span class="ico">üìÑ</span><span>Quotations</span>
          </a>
          <a href="/dashboard/clients.html"
            ><span class="ico">üë•</span><span class="label">Clients</span></a
          >
          <a href="/dashboard/payments.html"
            ><span class="ico">üí≥</span><span class="label">Payments</span></a
          >
           <a href="/dashboard/templates.html"
            ><span class="ico">üí≥</span><span>Templates</span></a
          >
          <button class="btn btn-primary" onclick="createNewQuote()">
            New Quote
          </button>
          <button class="btn btn-secondary" onclick="saveQuoteToFirebase()">
            Save
          </button>
          <button class="btn btn-primary" onclick="savePDF()">
            Save as PDF
          </button>
          <a href="#"
            ><span class="ico">üìä</span><span class="label">Reports</span></a
          >
        </nav>

        <div class="spacer"></div>

        <div class="flex">
          <div
            style="
              width: 44px;
              height: 44px;
              border-radius: 10px;
              background: rgba(255, 255, 255, 0.04);
              display: flex;
              align-items: center;
              justify-content: center;
            "
          >
            üë§
          </div>
          <div>
            <div style="font-weight: 700; color: white">User</div>
            <div style="font-size: 12px; color: #9aa7b2">Admin</div>
          </div>
        </div>
      </aside>
      <div class="sidebar-overlay" id="sidebarOverlay"></div>

      <div class="quote-container" id="quote" style="flex: block">
        <!-- Header -->
        <div class="header">
          <div class="header-info">
            <!-- LEFT SIDE: Logo and Contact Info -->
            <div class="contact-info">
              <div>
                <img
                  src="/assets/img/v8-logo.png"
                  alt=""
                  style="width: 300px"
                />
              </div>

              <div class="office-addresses">
                <div class="office">
                  <strong>HEAD OFFICE:</strong><br />
                  8-10 CNR THIRD &amp; ARKWRIGHT AVENUE<br />
                  WYNBERG SANDTON 2090,<br />

                  <strong>BRANCH:</strong><br />
                  1 LINBRI AVE GROBLERSDAL<br />
                  LIMPOPO 0470 <br />
                  W: v8poweredrc.co.za<br />
                  E: info@v8poweredrc.co.za<br />
                  T: 062 114 4500, 064 503 0029
                </div>
              </div>
            </div>

            <!-- RIGHT SIDE: Quote Meta -->
            <div class="quote-meta">
              <div class="quote-type">QUOTATION</div>

              <div class="meta-box">
                <div class="meta-label">Quote No.</div>
                <input type="text" id="quoteNumber" value="QT-2025-001" />
              </div>

              <div class="meta-box">
                <div class="meta-label">Date</div>
                <input type="date" id="quoteDate" value="2025-12-08" />
              </div>

              <div class="meta-box">
                <div class="meta-label">Merchant Code</div>
                <input type="text" id="merchantCode" value="V8PA-12345" />
              </div>

              <div class="meta-box">
                <div class="meta-label">Service Type</div>
                <input type="text" id="serviceType" value="SERVICE" />
              </div>
            </div>
          </div>
        </div>
        <!-- Quote Meta -->

        <!-- Client & Vehicle Info -->
        <div class="info-section">
          <div class="info-box" style="border: 1px solid #b9b7b7;border-radius: 5px; box-shadow: #cfe9f7;">
            <div class="info-title">QUOTE TO</div>
            <div class="info-content">
              <div class="info-row">
                <strong>Name:</strong>
                <input type="text" id="clientName" value="Customer" />
              </div>
              <div class="info-row">
                <strong>Company:</strong>
                <input type="text" id="emailAddress" value="ABC Limited" />
              </div>
              <div class="info-row">
                <strong>Address:</strong>
                <textarea
                  id="clientInfo"
                  placeholder="Enter client name and address"
                  style="text-align: start"
                >
123 Main Street Sandton, Johannesburg 2090
                </textarea>
              </div>
              <div class="info-row">
                <strong>Email:</strong>
                <input type="text" id="regNumber" value="ABC 123 GP" />
              </div>
              <div class="info-row">
                <strong>Tel:</strong>
                <input type="text" id="regNumber" value="ABC 123 GP" />
              </div>
            </div>
          </div>
          <div class="info-box" style="border: 1px solid #b9b7b7;border-radius: 5px; box-shadow: #cfe9f7;">
            <div class="info-title">BILL TO</div>
            <div class="info-content">
              <div class="info-row">
                <strong>Name:</strong>
                <input
                  type="text"
                  id="clientName"
                  style="color: #00000052"
                  value="Customer"
                />
              </div>
              <div class="info-row">
                <strong>Company:</strong>
                <input type="text" id="emailAddress" value="ABC Limited" />
              </div>
              <div class="info-row">
                <strong>Address:</strong>
                <textarea
                  id="clientInfo"
                  placeholder="Enter client name and address"
                  style="text-align: start"
                >
123 Main Street Sandton, Johannesburg 2090
                </textarea>
              </div>
              <div class="info-row">
                <strong>Email:</strong>
                <input type="text" id="regNumber" value="ABC 123 GP" />
              </div>
              <div class="info-row">
                <strong>Tel:</strong>
                <input type="text" id="regNumber" value="ABC 123 GP" />
              </div>
            </div>
          </div>
          <div class="info-box" style="border: 1px solid #b9b7b7; border-radius: 5px; box-shadow: #cfe9f7;">
            <div class="info-title">VEHICLE DETAILS</div>
            <div class="info-content">
              <div class="info-row">
                <strong>Reg Number:</strong>
                <input type="text" id="regNumber" value="ABC 123 GP" />
              </div>
              <div class="info-row">
                <strong>Make:</strong>
                <input type="text" id="make" value="Toyota" />
              </div>
              <div class="info-row">
                <strong>Model:</strong>
                <input type="text" id="model" value="Hilux 2.8 GD-6" />
              </div>
              <div class="info-row">
                <strong>Engine No:</strong>
                <input type="text" id="engine" value="h78627282" />
              </div>
              <div class="info-row">
                <strong>VIN Number:</strong>
                <input type="text" id="vinNumber" value="AHTFS26L5G0000000" />
              </div>
              <div class="info-row">
                <strong>Odometer:</strong>
                <input type="text" id="odometer" value="45,230 km" />
              </div>
              <div class="info-row">
                <strong>Pre Auth:</strong>
                <input type="text" id="preAuth" value="AUTH123" />
              </div>
              <div class="info-row">
                <strong>Auth Code:</strong>
                <input type="text" id="authCode" value="456789" />
              </div>
            </div>
          </div>
        </div>

        <!-- Items Table -->
        <table class="items-table" id="itemsTable">
          <thead>
            <tr>
              <th style="width: 55%">ITEM DESCRIPTION</th>
              <th class="text-center" style="width: 10%">QUANTITY</th>
              <th class="text-right" style="width: 15%">UNIT PRICE</th>
              <th class="text-right" style="width: 20%">NET PRICE</th>
            </tr>
          </thead>
          <tbody id="itemsBody">
            <tr class="item-row">
              <td>
                <input
                  type="text"
                  class="item-desc"
                  value="Engine Oil Change - Full Synthetic 5W-30"
                />
              </td>
              <td class="text-center">
                <input
                  type="number"
                  class="item-qty"
                  value="1"
                  min="0"
                  step="1"
                  onchange="calculateRow(this)"
                />
              </td>
              <td class="text-right">
                <input
                  type="number"
                  class="item-price"
                  value="850.00"
                  min="0"
                  step="0.01"
                  onchange="calculateRow(this)"
                />
              </td>
              <td class="text-right">
                <span class="net-price">R 850.00</span>
              </td>
              <td class="text-center">
                <button class="btn-remove" onclick="removeRow(this)">
                  Remove
                </button>
              </td>
            </tr>
          </tbody>
        </table>

        <button class="btn-add" onclick="addRow()">+ Add Item</button>

        <!-- Totals -->
        <div class="totals">
          <div class="total-row subtotal">
            <span>Subtotal:</span>
            <span id="subtotal">R 850.00</span>
          </div>
          <div class="total-row">
            <span>VAT:</span>
            <span id="vat">R 127.50</span>
          </div>
          <div class="total-row grand-total">
            <span>TOTAL:</span>
            <span id="total">R 977.50</span>
          </div>
        </div>
         <div>
          <div class="signatures" style="margin-top: 40px; font-size: 10px;">
            <div>
              WORKSHOP SIGNATURE __________________CLIENT  SIGNATURE  ___________________CONTACT NUMBER:  _________________________<br/>
            </div> 
            
          </div>
         </div>
        <!-- Footer -->
        <div class="footer">
          <div class="bank-details">
            <div class="bank-title">BANKING DETAILS</div>
            <div class="bank-info">
              <div><strong>Bank Name:</strong> FNB</div>
              <div><strong>Account Holder:</strong> V8 POWERED AUTO</div>
              <div><strong>Branch Name:</strong> LIFESTYLE CENTURION</div>
              <div><strong>Account Number:</strong> 63149991431</div>
            </div>
          </div>

          <div style="text-align: center" padding-top: 30px>
            <p style="font-size: 16px; color: #b71c1c">
              NB: All our parts and workmanship have 12 months or 15000KM
              Guarantee.
            </p>
          </div>
        </div>
      </div>
    </div>

     <script>
      // Calculate net price for a row
      function calculateRow(input) {
        const row = input.closest("tr");
        const qty = parseFloat(row.querySelector(".item-qty").value) || 0;
        const price = parseFloat(row.querySelector(".item-price").value) || 0;
        const netPrice = qty * price;

        row.querySelector(".net-price").textContent =
          "R " + netPrice.toFixed(2);
        calculateTotals();
      }

      // Calculate all totals
      function calculateTotals() {
        let subtotal = 0;
        document.querySelectorAll(".item-row").forEach((row) => {
          const qty = parseFloat(row.querySelector(".item-qty").value) || 0;
          const price = parseFloat(row.querySelector(".item-price").value) || 0;
          subtotal += qty * price;
        });

        const vat = subtotal * 0;
        const total = subtotal + vat;

        document.getElementById("subtotal").textContent =
          "R " + subtotal.toFixed(2);
        document.getElementById("vat").textContent = "R " + vat.toFixed(2);
        document.getElementById("total").textContent = "R " + total.toFixed(2);
      }

      // Add new row
      function addRow() {
        const tbody = document.getElementById("itemsBody");
        const newRow = document.createElement("tr");
        newRow.className = "item-row";
        newRow.innerHTML = `
        <td><input type="text" class="item-desc" placeholder="Item description"></td>
        <td class="text-center"><input type="number" class="item-qty" value="1" min="0" step="1" onchange="calculateRow(this)"></td>
        <td class="text-right"><input type="number" class="item-price" value="0.00" min="0" step="0.01" onchange="calculateRow(this)"></td>
        <td class="text-right"><span class="net-price">R 0.00</span></td>
        <td class="text-center"><button class="btn-remove" onclick="removeRow(this)">Remove</button></td>
    `;
        tbody.appendChild(newRow);
        calculateTotals();
      }

      // Remove row
      function removeRow(button) {
        if (document.querySelectorAll(".item-row").length > 1) {
          button.closest("tr").remove();
          calculateTotals();
        } else {
          alert("You must have at least one item.");
        }
      }

      class QuoteCounter {
        constructor() {
          this.counter = 1; // Start at 1
          this.prefix = "QT";
        }

        // Generate quote number with current counter
        generate() {
          const year = new Date().getFullYear();
          const paddedNum = String(this.counter).padStart(3, "0");
          return `${this.prefix}-${year}-${paddedNum}`;
        }

        // Get current quote number without incrementing
        getCurrent() {
          return this.generate();
        }

        // Get next quote number and increment counter
        getNext() {
          this.counter++;
          return this.generate();
        }

        // Set counter to specific number
        setCounter(num) {
          this.counter = Math.max(1, parseInt(num) || 1);
        }

        // Parse and update counter from existing quote number
        parseAndUpdate(quoteNo) {
          const match = quoteNo.match(/QT-\d{4}-(\d+)/);
          if (match) {
            const num = parseInt(match[1], 10);
            if (num >= this.counter) {
              this.counter = num + 1;
            }
          }
        }
      }

      // Create global instance
      const quoteCounter = new QuoteCounter();

      // Initialize quote system
      document.addEventListener("DOMContentLoaded", function () {
        const quoteNumberInput = document.getElementById("quoteNumber");

        // Set initial quote number
        quoteNumberInput.value = quoteCounter.getCurrent();

        
        const newQuoteBtn = document.getElementById("newQuoteBtn");
        if (newQuoteBtn) {
          newQuoteBtn.addEventListener("click", function () {
            // Clear form and set new quote number
            const newQuoteNo = quoteCounter.getNext();
            quoteNumberInput.value = newQuoteNo;
            console.log("New quote:", newQuoteNo);
          });
        }

        // Hook into "Save Quote" button
        const saveBtn = document.getElementById("saveQuote");
        if (saveBtn) {
          saveBtn.addEventListener("click", function () {
            console.log("Saved quote:", quoteNumberInput.value);

            // After saving, prepare next quote number
            setTimeout(() => {
              const nextQuoteNo = quoteCounter.getNext();
              quoteNumberInput.value = nextQuoteNo;
              console.log("Ready for next quote:", nextQuoteNo);
            }, 1000);
          });
        }

        // Optional: Allow manual editing and sync counter
        quoteNumberInput.addEventListener("blur", function () {
          quoteCounter.parseAndUpdate(this.value);
        });
      });

      // Export for use in other scripts
      window.quoteCounter = quoteCounter;
      // Create new quote
      function createNew() {
        if (
          confirm(
            "Are you sure you want to create a new quote? All current data will be cleared."
          )
        ) {
          const nextQuoteNo = getNextQuoteNumber();
          localStorage.setItem("lastQuoteNo", nextQuoteNo);
          location.reload();
        }
      }

      // Save as PDF
      function savePDF() {
        window.print();
      }
      function initializeQuote() {
        // Load last quote number and increment
        const lastQuoteNo = localStorage.getItem("lastQuoteNo");
        if (lastQuoteNo) {
          document.getElementById("quoteNumber").value = lastQuoteNo;
        } else {
          // First time, set initial value
          const year = new Date().getFullYear();
          document.getElementById("quoteNumber").value = `QT-${year}-001`;
        }

        // Set today's date
        const today = new Date().toISOString().split("T")[0];
        document.getElementById("quoteDate").value = today;

        calculateTotals();
      }

      initializeQuote();
      // Initialize
      calculateTotals();

      const overlay = document.getElementById("sidebarOverlay");
      overlay.addEventListener("click", () => {
        sidebar.classList.remove("open");
        sidebar.setAttribute("aria-hidden", true);
      });
    </script>
    <script
      type="text/javascript"
      src="https://assets.calendly.com/assets/external/widget.js"
      async
    ></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script>
      // Wait for Firebase to be fully initialized before using it
      let firebaseReady = false;

      // Initialize Firebase and set ready flag
      function initializeFirebaseApp() {
        const firebaseConfig = {
          apiKey: "AIzaSyD1Xzk2DL-kuxEMgbomupgAF0IQZWso8PQ",
          authDomain: "solidflow-1f753.firebaseapp.com",
          projectId: "solidflow-1f753",
          storageBucket: "solidflow-1f753.firebasestorage.app",
          messagingSenderId: "68885400864",
          appId: "1:68885400864:web:7788e19a073d9a8e79db45",
          measurementId: "G-RTL0CM1B44",
        };

        // Initialize Firebase only if not already initialized
        if (!firebase.apps.length) {
          firebase.initializeApp(firebaseConfig);
        }

        firebaseReady = true;
        console.log("Firebase initialized successfully");
      }

      // Function to get the next quote number from Firebase
      async function getNextQuoteNumber() {
        // Fallback helper
        const getFallbackNumber = () => {
          const year = new Date().getFullYear();
          return `QT-${year}-001`;
        };

        if (!firebaseReady) {
          console.error("Firebase not ready yet");
          return getFallbackNumber();
        }

        const user = firebase.auth().currentUser;
        if (!user) {
          console.error("No user logged in");
          return getFallbackNumber();
        }

        const userId = user.uid;
        const year = new Date().getFullYear();

        try {
          const db = firebase.firestore();
          const quotesRef = db
            .collection("users")
            .doc(userId)
            .collection("quotations");

          // Query last quote for current year (more efficient)
          const yearStart = `QT-${year}-000`;
          const yearEnd = `QT-${year}-999`;

          const snapshot = await quotesRef
            .where("quoteNumber", ">=", yearStart)
            .where("quoteNumber", "<=", yearEnd)
            .orderBy("quoteNumber", "desc")
            .limit(1)
            .get();

          let nextNumber = 1;

          if (!snapshot.empty) {
            const lastQuote = snapshot.docs[0].data();
            const lastQuoteNumber = lastQuote.quoteNumber;

            console.log("Last quote found:", lastQuoteNumber);

            // Extract the numeric part
            const match = lastQuoteNumber.match(/QT-(\d{4})-(\d{3})/);

            if (match) {
              const lastYear = parseInt(match[1]);
              const lastNumber = parseInt(match[2]);

              // Should always be current year due to query filter
              if (lastYear === year) {
                nextNumber = lastNumber + 1;
              }
            }
          } else {
            console.log(
              "No existing quotes found for",
              year,
              "- starting with 001"
            );
          }

          // Format: QT-YYYY-XXX
          const paddedNumber = String(nextNumber).padStart(3, "0");
          const newQuoteNumber = `QT-${year}-${paddedNumber}`;

          console.log("Generated quote number:", newQuoteNumber);
          return newQuoteNumber;
        } catch (error) {
          console.error("Error fetching last quote:", error);
          return getFallbackNumber();
        }
      }

      // Load quote data from Firestore when page loads
async function loadQuoteFromFirestore() {
  const quoteNumber = sessionStorage.getItem("loadQuoteNumber");
  
  if (!quoteNumber) {
    console.log("No quote to load");
    return;
  }

  const user = firebase.auth().currentUser;
  if (!user) {
    console.error("No user logged in");
    return;
  }

  try {
    // Query for the quote by quoteNumber
    const snapshot = await firebase.firestore()
      .collection("users")
      .doc(user.uid)
      .collection("quotations")
      .where("quoteNumber", "==", quoteNumber)
      .limit(1)
      .get();

    if (snapshot.empty) {
      console.error("Quote not found:", quoteNumber);
      alert("Quote not found!");
      sessionStorage.removeItem("loadQuoteNumber");
      return;
    }

    // Get the quote data
    const quoteDoc = snapshot.docs[0];
    const quoteData = quoteDoc.data();
    
    console.log("Loading quote data:", quoteData);

    // Populate the form fields
    document.getElementById("quoteNumber").value = quoteData.quoteNumber || "";
    document.getElementById("quoteDate").value = quoteData.quoteDate || "";
    document.getElementById("merchantCode").value = quoteData.merchantCode || "";
    document.getElementById("serviceType").value = quoteData.serviceType || "";
    
    // Client information
    document.getElementById("clientName").value = quoteData.clientName || "";
    document.getElementById("clientAddress").value = quoteData.clientAddress || "";
    document.getElementById("clientContact").value = quoteData.clientContact || "";
    
    // Vehicle/Job information (if you have these fields)
    if (document.getElementById("vehicleMake")) {
      document.getElementById("vehicleMake").value = quoteData.vehicleMake || "";
    }
    if (document.getElementById("vehicleModel")) {
      document.getElementById("vehicleModel").value = quoteData.vehicleModel || "";
    }
    if (document.getElementById("vehicleReg")) {
      document.getElementById("vehicleReg").value = quoteData.vehicleReg || "";
    }
    if (document.getElementById("vehicleVin")) {
      document.getElementById("vehicleVin").value = quoteData.vehicleVin || "";
    }
    if (document.getElementById("mileage")) {
      document.getElementById("mileage").value = quoteData.mileage || "";
    }

    // Load line items
    if (quoteData.items && quoteData.items.length > 0) {
      // Clear existing items first
      const itemsTableBody = document.getElementById("itemsTableBody");
      itemsTableBody.innerHTML = "";
      
      // Add each item
      quoteData.items.forEach((item, index) => {
        addItemRow(); // Add a new row
        
        // Get the newly added row
        const rows = itemsTableBody.getElementsByTagName("tr");
        const newRow = rows[rows.length - 1];
        
        // Populate the row with data
        newRow.querySelector('input[placeholder="Description"]').value = item.description || "";
        newRow.querySelector('input[placeholder="Qty"]').value = item.qty || 0;
        newRow.querySelector('input[placeholder="Unit Price"]').value = item.unitPrice || 0;
        newRow.querySelector('input[placeholder="Discount %"]').value = item.discount || 0;
      });
    }

    // Load notes and terms
    if (document.getElementById("notes")) {
      document.getElementById("notes").value = quoteData.notes || "";
    }
    if (document.getElementById("terms")) {
      document.getElementById("terms").value = quoteData.terms || "";
    }

    // Recalculate totals
    if (typeof calculateTotals === 'function') {
      calculateTotals();
    }

    // Clear the session storage
    sessionStorage.removeItem("loadQuoteNumber");
    
    alert("Quote loaded successfully!");

  } catch (error) {
    console.error("Error loading quote:", error);
    alert("Error loading quote: " + error.message);
  }
}
function loadUserProfile(user) {
  db.collection("users").doc(user.uid).get()
    .then((doc) => {
      if (doc.exists) {
        const userData = doc.data();
        // Update profile display if you have these elements
        const profileName = document.querySelector('.flex div:last-child div:first-child');
        const profileRole = document.querySelector('.flex div:last-child div:last-child');
        
        if (profileName) {
          profileName.textContent = userData.name || 'User';
        }
        if (profileRole) {
          profileRole.textContent = (userData.role || 'user').charAt(0).toUpperCase() + (userData.role || 'user').slice(1);
        }
      }
    })
    .catch((error) => {
      console.error("Error loading profile:", error);
    });
}
// Call this function when the quote page loads
firebase.auth().onAuthStateChanged((user) => {
  if (user) {
   currentUserId = user.uid;
    firebaseReady = true;
    
    // Load user profile
    loadUserProfile(user);
    
    // Load quotes
    displayQuotesTable();
    const quoteToLoad = sessionStorage.getItem("loadQuoteNumber");
    if (quoteToLoad) {
      loadQuoteFromFirestore();
    }
  }
});
      async function initializeQuoteNumber() {
        const quoteInput = document.getElementById("quoteNumber");

        if (!quoteInput) {
          console.error("Quote number input not found");
          return;
        }

        // Show loading state
        quoteInput.value = "Loading...";
        quoteInput.disabled = true;

        try {
          const newQuoteNumber = await getNextQuoteNumber();
          quoteInput.value = newQuoteNumber;
        } catch (error) {
          console.error("Error initializing quote:", error);
          const year = new Date().getFullYear();
          quoteInput.value = `QT-${year}-001`;
        } finally {
          quoteInput.disabled = false;
        }
      }

     
        async function saveQuoteToFirebase() {
      console.log("üíæ Attempting to save quote...");

      // Helper to wait for firebaseReady flag
      function waitForFirebaseReady(timeoutMs = 5000) {
        return new Promise((resolve, reject) => {
        const start = Date.now();
        (function check() {
          if (firebaseReady) return resolve();
          if (Date.now() - start > timeoutMs) return reject(new Error('timeout'));
          setTimeout(check, 100);
        })();
        });
      }

      if (!firebaseReady) {
        console.log('Firebase not ready yet ‚Äî attempting to initialize now');
        try {
          initializeFirebaseApp();
          await waitForFirebaseReady(5000);
        } catch (err) {
          console.error('Firebase failed to initialize in time', err);
        }
      }

      if (!firebaseReady) {
        alert("Firebase is not initialized yet. Please wait a moment and try again.");
        return;
      }

      const user = firebase.auth().currentUser;
      if (!user) {
        alert("You must be logged in to save an quote.");
        return;
      }

      const userId = user.uid;
      const quoteNumber = document.getElementById("quoteNumber").value;

      if (!quoteNumber || quoteNumber === "Loading..." || quoteNumber === "Error loading") {
        alert("Please wait for quote number to load");
        return;
      }

      // Check if quote already exists
      try {
        const db = firebase.firestore();
        const docRef = db
          .collection("users")
          .doc(userId)
          .collection("quotations")
          .doc(quoteNumber);

        const docSnapshot = await docRef.get();

        if (docSnapshot.exists) {
          alert(`Quote ${quoteNumber} has already been saved. Please create a new quote using the "New Quote" button.`);
          return;
        }
      } catch (error) {
        console.error("Error checking if quote exists:", error);
        alert("Error checking quote: " + error.message);
        return;
      }

      // Collect quote data
      const quoteData = {
        quoteNumber: quoteNumber,
        quoteDate: document.getElementById("quoteDate").value,
        merchantCode: document.getElementById("merchantCode").value,
        serviceType: document.getElementById("serviceType").value,
        clientName: document.getElementById("clientName").value,
        emailAddress: document.getElementById("emailAddress").value,
        clientInfo: document.getElementById("clientInfo").value,
        regNumber: document.getElementById("regNumber").value,
        make: document.getElementById("make").value,
        model: document.getElementById("model").value,
        engine: document.getElementById("engine").value,
        vinNumber: document.getElementById("vinNumber").value,
        odometer: document.getElementById("odometer").value,
        preAuth: document.getElementById("preAuth").value,
        authCode: document.getElementById("authCode").value,
        items: Array.from(document.querySelectorAll("#itemsBody tr.item-row")).map((row) => ({
          description: row.querySelector(".item-desc").value,
          quantity: parseFloat(row.querySelector(".item-qty").value),
          unitPrice: parseFloat(row.querySelector(".item-price").value),
          netPrice: parseFloat(row.querySelector(".net-price").textContent.replace(/[^\d\.]/g, ""))
        })),
        subtotal: document.getElementById("subtotal").textContent,
        vat: document.getElementById("vat").textContent,
        total: document.getElementById("total").textContent,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      };

      // Save to Firebase - THIS IS THE ACTUAL SAVE
      try {
        const db = firebase.firestore();
        await db
          .collection("users")
          .doc(userId)
          .collection("quotations")
          .doc(quoteData.quoteNumber)
          .set(quoteData);

        // SUCCESS - Now we can celebrate
        console.log("‚úÖ Quote saved successfully:", quoteData.quoteNumber);
        alert("Quote saved successfully!");

        // Generate next quote number
        await initializeQuoteNumber();

        // Clear form fields
        clearQuoteFormFields();

      } catch (error) {
        console.error("‚ùå Error saving quote:", error);
        alert("Failed to save quote: " + error.message);
      }
    }
function addItemRow() {
  const tbody = document.getElementById("itemsTableBody");
  const newRow = document.createElement("tr");
  
  newRow.innerHTML = `
    <td><input type="text" placeholder="Description" oninput="calculateTotals()" /></td>
    <td><input type="number" placeholder="Qty" value="1" oninput="calculateTotals()" /></td>
    <td><input type="number" placeholder="Unit Price" value="0" oninput="calculateTotals()" /></td>
    <td><input type="number" placeholder="Discount %" value="0" oninput="calculateTotals()" /></td>
    <td class="net-price">R 0.00</td>
    <td style="text-align: center;">
      <button type="button" class="btn-remove" onclick="removeItemRow(this)">√ó</button>
    </td>
  `;
  
  tbody.appendChild(newRow);
  calculateTotals();
}      
function clearQuoteFormFields() {
  // Clear all fields EXCEPT quote number (which was just initialized)
  document.getElementById("clientName").value = "";
  document.getElementById("emailAddress").value = "";
  document.getElementById("clientInfo").value = "";
  document.getElementById("regNumber").value = "";
  document.getElementById("make").value = "";
  document.getElementById("model").value = "";
  document.getElementById("engine").value = "";
  document.getElementById("vinNumber").value = "";
  document.getElementById("odometer").value = "";
  document.getElementById("preAuth").value = "";
  document.getElementById("authCode").value = ""; 
  document.getElementById("itemsBody").innerHTML = "";
  addItemRow(); // Add one empty row
}
      // Function to create new quote (clears form and gets next number)
      async function createNewQuote() {
        if (
          confirm(
            "Are you sure you want to create a new quote? All current data will be cleared."
          )
        ) {
          // Clear all inputs
          document.getElementById("clientName").value = "";
          document.getElementById("emailAddress").value = "";
          document.getElementById("clientInfo").value = "";
          document.getElementById("regNumber").value = "";
          document.getElementById("make").value = "";
          document.getElementById("model").value = "";
          document.getElementById("engine").value = "";
          document.getElementById("vinNumber").value = "";
          document.getElementById("odometer").value = "";
          document.getElementById("preAuth").value = "";
          document.getElementById("authCode").value = "";

          // Clear items except first row
          const itemsBody = document.getElementById("itemsBody");
          while (itemsBody.children.length > 1) {
            itemsBody.removeChild(itemsBody.lastChild);
          }

          // Clear first row
          const firstRow = itemsBody.querySelector(".item-row");
          if (firstRow) {
            firstRow.querySelector(".item-desc").value = "";
            firstRow.querySelector(".item-qty").value = "1";
            firstRow.querySelector(".item-price").value = "0.00";
          }

          // Get next quote number
          await initializeQuoteNumber();

          // Reset date to today
          const today = new Date().toISOString().split("T")[0];
          document.getElementById("quoteDate").value = today;

          calculateTotals();
        }
      }

      // Initialize when DOM is ready
      document.addEventListener("DOMContentLoaded", async function () {
        // Initialize Firebase first
        initializeFirebaseApp();

        // Wait a bit for Firebase to fully initialize
        setTimeout(async () => {
          await initializeQuoteNumber();
        }, 1000);

        // Set today's date
        const today = new Date().toISOString().split("T")[0];
        const quoteDateInput = document.getElementById("quoteDate");
        if (quoteDateInput && !quoteDateInput.value) {
          quoteDateInput.value = today;
        }

        calculateTotals();
      });
    </script>
    <script>
      // Example total calculator ‚Äî replace with your own logic
      function calculateTotalAmount() {
        const totalElement = document.getElementById("totalAmount");
        return parseFloat(totalElement?.value || 0);
      }
      const sidebarEl = document.getElementById("sidebar");
      const hambtn = document.getElementById("hambtn");
      const closeBtn = document.getElementById("closeSidebar");
      hambtn.addEventListener("click", () =>
        sidebarEl.classList.toggle("open")
      );
      closeBtn.addEventListener("click", () => {
        sidebar.classList.remove("open");
        sidebar.setAttribute("aria-hidden", "true");
      });
      document.addEventListener("click", (e) => {
        if (window.innerWidth <= 820) {
          const inside =
            sidebarEl.contains(e.target) ||
            hambtn.contains(e.target) ||
            document.getElementById("settingsDrawer").contains(e.target);
          if (!inside) sidebarEl.classList.remove("open");
        }
      });
      document.addEventListener("contextmenu", (e) => {
        e.preventDefault();
        return false;
      });

      // Disable keyboard shortcuts (optional - prevents Ctrl+S, Ctrl+U, etc.)
      document.addEventListener("keydown", (e) => {
        // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
        if (
          e.keyCode === 123 || // F12
          (e.ctrlKey && e.shiftKey && e.keyCode === 73) || // Ctrl+Shift+I
          (e.ctrlKey && e.shiftKey && e.keyCode === 74) || // Ctrl+Shift+J
          (e.ctrlKey && e.keyCode === 85)
        ) {
          // Ctrl+U
          e.preventDefault();
          return false;
        }
      });
    </script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  </body>
</html>
